<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Finance Hub</title>
  <style>
    :root {
      --bg: #4b001f;
      --section-bg: rgba(255,255,255,0.05);
      --card-bg: rgba(255,255,255,0.1);
      --text: #f3ecec;
      --muted: #dcdcdc;
      --accent: #ff4d75;
      --hover: #ff6f91;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    header {
      background: rgba(0,0,0,0.3);
      text-align: center;
      padding: 30px 20px;
    }
    header h1 {
      margin: 0;
      font-size: 2.2em;
      color: var(--accent);
    }
    main {
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px 80px;
    }
    section {
      background: var(--section-bg);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 40px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }
    h2 {
      font-size: 1.6em;
      margin-bottom: 20px;
      border-bottom: 2px solid var(--accent);
      display: inline-block;
      padding-bottom: 5px;
    }
    .cards {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    .card {
      background: var(--card-bg);
      padding: 16px;
      border-radius: 10px;
      flex: 1 1 140px;
      min-width: 140px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      background: var(--hover);
    }
    .card .label {
      font-size: 0.9em;
      margin-bottom: 8px;
      color: var(--muted);
    }
    .card .value {
      font-size: 1.4em;
      font-weight: bold;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 10px 8px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      color: var(--text);
    }
    th {
      color: var(--accent);
      font-weight: bold;
    }
    input[type="text"], input[type="number"], input[type="date"] {
      padding: 8px;
      border: none;
      border-radius: 6px;
      background: var(--card-bg);
      color: var(--text);
      margin-right: 8px;
    }
    button {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      background: var(--accent);
      color: #fff;
      cursor: pointer;
    }
    button:hover {
      background: var(--hover);
    }
    .back {
      display: inline-block;
      margin-bottom: 20px;
      color: var(--text);
      text-decoration: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Finance Hub</h1>
  </header>
  <main>
    <a class="back" href="index.html">&larr; Back to Hub</a>

    <section>
      <h2>Precious Metals</h2>
      <div class="cards">
        <div class="card">
          <div class="label">Gold (USD/oz)</div>
          <div class="value" id="gold-price">--</div>
        </div>
        <div class="card">
          <div class="label">Silver (USD/oz)</div>
          <div class="value" id="silver-price">--</div>
        </div>
      </div>
    </section>

    <section>
      <h2>Savings Tracker</h2>
      <div>
        <input type="date" id="sav-date" />
        <input type="number" id="sav-balance" placeholder="Balance" step="0.01" />
        <button onclick="addSavings()">Add</button>
      </div>
      <table id="savings-table">
        <thead><tr><th>Date</th><th>Balance</th></tr></thead>
        <tbody></tbody>
      </table>
      <canvas id="savings-chart" style="width:100%; height:300px;"></canvas>
    </section>

    <section>
      <h2>Home Inventory</h2>
      <div>
        <input type="text" id="inv-item" placeholder="Item" />
        <input type="text" id="inv-room" placeholder="Room/Location" />
        <input type="number" id="inv-value" placeholder="Replacement Value" step="0.01" />
        <input type="text" id="inv-desc" placeholder="Description" />
        <button onclick="addInventory()">Add</button>
      </div>
      <table id="inv-table">
        <thead><tr><th>Item</th><th>Room</th><th>Value</th><th>Description</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="label">Total Replacement Value: <span id="inv-total">0.00</span></div>
    </section>

    <section>
      <h2>Mortgage / Equity</h2>
      <div>
        <input type="number" id="mort-principal" placeholder="Original Mortgage" step="0.01" />
        <input type="number" id="mort-rate" placeholder="Interest Rate (%)" step="0.01" />
        <input type="number" id="mort-term" placeholder="Term (years)" />
        <input type="number" id="mort-homeval" placeholder="Home Value" step="0.01" />
        <button onclick="calcMortgage()">Calculate</button>
      </div>
      <div id="mort-results">
        <p>Remaining Balance: <span id="rem-balance">--</span></p>
        <p>Equity: <span id="equity">--</span></p>
        <p>Monthly Interest Portion: <span id="int-part">--</span></p>
        <p>Monthly Principal Portion: <span id="prin-part">--</span></p>
      </div>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // ========== Metal Prices ==========
    async function fetchMetalPrices(){
      try {
        // Using Goldpricez free JSON API (requires key but sample) :contentReference[oaicite:2]{index=2}
        const resp = await fetch('https://api.allorigins.win/raw?url=https://api.goldpricez.com/api/rates/currency/usd/measure/all');
        const js = await resp.json();
        // goldpricez returns keys: ounce_price_usd, etc.
        if(js.ounce_price_usd){
          document.getElementById('gold-price').innerText = js.ounce_price_usd.toFixed(2);
        }
        if(js.ounce_price_usd && js.ounce_price_silver_usd){
          document.getElementById('silver-price').innerText = js.ounce_price_silver_usd.toFixed(2);
        }
      } catch(err) {
        console.error('Metal price fetch failed', err);
      }
    }
    fetchMetalPrices();
    setInterval(fetchMetalPrices, 60 * 1000);

    // ========== Savings Tracker ==========
    let savings = [];

    function addSavings(){
      const dt = document.getElementById('sav-date').value;
      const bal = parseFloat(document.getElementById('sav-balance').value);
      if(!dt || isNaN(bal)) return;
      savings.push({ date: dt, balance: bal });
      renderSavings();
    }

    function renderSavings(){
      const tbody = document.getElementById('savings-table').querySelector('tbody');
      tbody.innerHTML = '';
      for(let rec of savings) {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${rec.date}</td><td>${rec.balance.toFixed(2)}</td>`;
        tbody.appendChild(tr);
      }
      updateSavingsChart();
    }

    function updateSavingsChart(){
      const labels = savings.map(r => r.date);
      const data = savings.map(r => r.balance);
      // If chart already exists, destroy it to re-render
      if(window._savingsChart){
        window._savingsChart.destroy();
      }
      window._savingsChart = new Chart(document.getElementById('savings-chart'), {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Savings Balance',
            data: data,
            borderColor: 'rgba(255, 205, 55, 1)',
            backgroundColor: 'rgba(255, 205, 55, 0.3)',
            tension: 0.2
          }]
        },
        options: {
          scales: {
            x: { title: { display: true, text: 'Date' } },
            y: { beginAtZero: false, title: { display: true, text: 'Balance (USD)' } }
          },
          parsing: {
            xAxisKey: 'date',
            yAxisKey: 'balance'
          }
        }
      });
    }

    // ========== Inventory ==========
    let inventory = [];
    function addInventory(){
      const item = document.getElementById('inv-item').value.trim();
      const room = document.getElementById('inv-room').value.trim();
      const val = parseFloat(document.getElementById('inv-value').value);
      const desc = document.getElementById('inv-desc').value.trim();
      if(!item || isNaN(val)) return;
      inventory.push({ item, room, value: val, desc });
      renderInventory();
    }
    function renderInventory(){
      const tbody = document.getElementById('inv-table').querySelector('tbody');
      tbody.innerHTML = '';
      let total = 0;
      for(let it of inventory){
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${it.item}</td><td>${it.room}</td><td>${it.value.toFixed(2)}</td><td>${it.desc}</td>`;
        tbody.appendChild(tr);
        total += it.value;
      }
      document.getElementById('inv-total').innerText = total.toFixed(2);
    }

    // ========== Mortgage / Equity ==========
    function calcMortgage(){
      const P = parseFloat(document.getElementById('mort-principal').value);
      const r_ann = parseFloat(document.getElementById('mort-rate').value);
      const n_years = parseInt(document.getElementById('mort-term').value);
      const V = parseFloat(document.getElementById('mort-homeval').value);
      if(isNaN(P) || isNaN(r_ann) || isNaN(n_years) || isNaN(V)) return;

      const r = r_ann / 100 / 12;
      const n = n_years * 12;
      const payment = (P * r) / (1 - Math.pow(1 + r, -n));

      // For demonstration, compute balance after 1 payment (youâ€™d adapt for k payments)
      const remaining = P * Math.pow(1+r, n) - payment * ( (Math.pow(1+r, n) - 1) / r );
      const equity = V - remaining;
      // Interest and principal portion approximate (just first month)
      const interestPortion = P * r;
      const principalPortion = payment - interestPortion;

      document.getElementById('rem-balance').innerText = remaining.toFixed(2);
      document.getElementById('equity').innerText = equity.toFixed(2);
      document.getElementById('int-part').innerText = interestPortion.toFixed(2);
      document.getElementById('prin-part').innerText = principalPortion.toFixed(2);
    }
  </script>
</body>
</html>
